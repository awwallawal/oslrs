# Story 1.5.7: Guide Detail Pages

Status: done

**Depends on:** Story 1.5.6 (Legal Pages & Navigation Cleanup) must be complete

## Story

As a **Worker or Employer**,
I want to **read detailed step-by-step guides for each registration task**,
so that I can **complete the process confidently and correctly**.

## Acceptance Criteria

1. **AC1: Worker Guide - How to Register (/support/guides/register)**
   - GIVEN a worker navigates to `/support/guides/register`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "How to Register"
     - Estimated time: "5-10 minutes"
     - Prerequisites section: NIN, valid email/phone, recent photo
     - Step-by-step numbered instructions:
       1. Visit the registration page
       2. Enter your NIN
       3. Verify your identity (selfie capture)
       4. Create account credentials
       5. Verify your email/phone
       6. Complete your profile
     - Tips section with helpful advice
     - "Back to Guides" link
     - "Related Guides" section with links to Survey and Marketplace guides

2. **AC2: Worker Guide - How to Complete the Survey (/support/guides/survey)**
   - GIVEN a worker navigates to `/support/guides/survey`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "How to Complete the Survey"
     - Estimated time: "10-15 minutes"
     - Prerequisites section: Completed registration, device with internet
     - Step-by-step numbered instructions:
       1. Log in to your account
       2. Navigate to the survey section
       3. Complete personal information
       4. Enter your skills and experience
       5. Answer employment history questions
       6. Save and submit
     - Tips section (saving progress, offline mode)
     - "Back to Guides" link
     - "Related Guides" section

3. **AC3: Worker Guide - How to Opt Into the Marketplace (/support/guides/marketplace-opt-in)**
   - GIVEN a worker navigates to `/support/guides/marketplace-opt-in`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "How to Opt Into the Marketplace"
     - Estimated time: "2 minutes"
     - Prerequisites section: Completed registration, completed survey
     - Step-by-step numbered instructions:
       1. Log in to your account
       2. Go to Privacy Settings
       3. Review marketplace consent options
       4. Choose your visibility level
       5. Confirm your choices
     - Information section explaining what employers can see
     - "Back to Guides" link
     - "Related Guides" section

4. **AC4: Worker Guide - How to Get a NIN (/support/guides/get-nin)**
   - GIVEN a worker navigates to `/support/guides/get-nin`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "How to Get a NIN"
     - Estimated time: "30-60 minutes at NIMC center"
     - What is NIN section explaining National Identification Number
     - Step-by-step numbered instructions:
       1. Find your nearest NIMC enrollment center
       2. Gather required documents (birth certificate, etc.)
       3. Visit the center during operating hours
       4. Complete biometric enrollment
       5. Receive your NIN slip
     - **Prominent CTA button** linking to NIMC enrollment centers: https://nimc.gov.ng/enrollment-centers/ (opens in new tab)
     - "Back to Guides" link
     - "Related Guides" section with Register guide
   - NOTE: This replaces the previous external-only link. Users now get context before leaving the site.

5. **AC5: Employer Guide - How to Search the Marketplace (/support/guides/search-marketplace)**
   - GIVEN an employer navigates to `/support/guides/search-marketplace`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "How to Search the Marketplace"
     - Estimated time: "Instant"
     - Prerequisites section: None (public search) or employer account (for contacts)
     - Step-by-step numbered instructions:
       1. Go to the Marketplace
       2. Use the search bar or filters
       3. Filter by skill, location, availability
       4. View worker profiles
       5. Contact workers (requires employer account)
     - Tips section for effective searching
     - "Back to Guides" link
     - "Related Guides" section with Employer Account guide

6. **AC6: Employer Guide - Setting Up an Employer Account (/support/guides/employer-account)**
   - GIVEN an employer navigates to `/support/guides/employer-account`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "Setting Up an Employer Account"
     - Estimated time: "2 minutes"
     - Why register section explaining benefits
     - Step-by-step numbered instructions:
       1. Click "Register" or "Create Employer Account"
       2. Enter business information
       3. Verify your email
       4. Complete your business profile
       5. Start searching workers
     - "Back to Guides" link
     - "Related Guides" section with Search Marketplace guide

7. **AC7: Employer Guide - How to Verify a Worker (/support/guides/verify-worker)**
   - GIVEN an employer navigates to `/support/guides/verify-worker`
   - WHEN the page renders
   - THEN the page MUST display:
     - H1: "How to Verify a Worker"
     - Estimated time: "1 minute"
     - What verification confirms section
     - Step-by-step numbered instructions:
       1. Obtain the worker's verification code
       2. Go to the Verify Worker page
       3. Enter the code (OSLSR-XXXX-XXXX format)
       4. View verification results
       5. Understand what results mean
     - Link to verification tool: `/support/verify-worker`
     - "Back to Guides" link
     - "Related Guides" section

8. **AC8: GuidesPage.tsx Link Updates**
   - GIVEN the existing GuidesPage at `/support/guides`
   - WHEN the page renders
   - THEN each worker guide card "Read Guide →" link MUST point to:
     - How to Register → `/support/guides/register`
     - How to Complete the Survey → `/support/guides/survey`
     - How to Opt Into the Marketplace → `/support/guides/marketplace-opt-in`
     - How to Get a NIN → `/support/guides/get-nin` (change `external: true` to `false`)
   - AND each employer guide card "Read Guide →" link MUST point to:
     - How to Search the Marketplace → `/support/guides/search-marketplace`
     - How to Create an Employer Account → `/support/guides/employer-account`
     - How to Verify a Worker → `/support/guides/verify-worker`

9. **AC9: Routing Integration in App.tsx**
   - GIVEN the current `/support/guides` is a single route (App.tsx lines 219-226)
   - WHEN implementing guide detail pages
   - THEN the single route MUST be converted to nested routes under `/support/guides/*`:
    ```tsx
    <Route path="guides">
      <Route index element={<GuidesPage />} />
      <Route path="register" element={<GuideRegisterPage />} />
      <Route path="survey" element={<GuideSurveyPage />} />
      <Route path="marketplace-opt-in" element={<GuideMarketplaceOptInPage />} />
      <Route path="get-nin" element={<GuideGetNinPage />} />
      <Route path="search-marketplace" element={<GuideSearchMarketplacePage />} />
      <Route path="employer-account" element={<GuideEmployerAccountPage />} />
      <Route path="verify-worker" element={<GuideVerifyWorkerPage />} />
    </Route>
    ```
   - AND all guide pages MUST be lazy loaded
   - AND all pages MUST use PublicLayout

10. **AC10: Shared Guide Page Components**
    - GIVEN multiple guide pages with similar structure
    - WHEN implementing guide pages
    - THEN shared components SHOULD be created:
      - `GuidePageLayout.tsx` - consistent layout with back link, time estimate, related guides
      - `StepList.tsx` - numbered step list component
      - `TipCard.tsx` - tip/callout component for helpful information
      - `RelatedGuides.tsx` - related guides section

11. **AC11: Testing Requirements**
    - GIVEN the feature test pattern
    - WHEN implementing tests
    - THEN tests MUST:
      - Test all 7 guide detail pages render correctly
      - Test each page has required sections (H1, steps, prerequisites)
      - Test "Back to Guides" links navigate to `/support/guides`
      - Test GuidesPage links correctly route to detail pages
      - Achieve minimum 80% coverage for guide pages

## Tasks / Subtasks

- [x] **Task 0: Prerequisites & Analysis** (AC: all)
  - [x] 0.1 Review existing GuidesPage.tsx to understand current structure
  - [x] 0.2 Review existing GuideCard component structure
  - [x] 0.3 Plan shared component architecture

- [x] **Task 1: Shared Guide Components** (AC: 10)
  - [x] 1.1 Create `apps/web/src/features/support/components/GuidePageLayout.tsx`:
    - Props: title, estimatedTime, prerequisites?, children, relatedGuides?
    - Consistent header with H1, time estimate badge
    - Prerequisites section (optional)
    - Content slot for steps
    - "Back to Guides" link
    - Related Guides section (optional)
  - [x] 1.2 Create `apps/web/src/features/support/components/StepList.tsx`:
    - Props: steps (array of { title, description })
    - Numbered step list with icons
    - Clear visual hierarchy
  - [x] 1.3 Create `apps/web/src/features/support/components/TipCard.tsx`:
    - Props: title?, children, variant? ('info' | 'warning' | 'success')
    - Reuse AboutCallout pattern or create similar
  - [x] 1.4 Create `apps/web/src/features/support/components/RelatedGuides.tsx`:
    - Props: guides (array of { href, title, description })
    - Grid of related guide links

- [x] **Task 2: Worker Guide Pages** (AC: 1, 2, 3, 4)
  - [x] 2.1 Create `apps/web/src/features/support/pages/guides/GuideRegisterPage.tsx`
    - H1: "How to Register"
    - Time: 5-10 minutes
    - Prerequisites: NIN, email/phone, photo
    - 6 steps as specified in AC1
    - Tips section
    - Related: Survey, Marketplace guides
  - [x] 2.2 Create `apps/web/src/features/support/pages/guides/GuideSurveyPage.tsx`
    - H1: "How to Complete the Survey"
    - Time: 10-15 minutes
    - Prerequisites: Registration, internet
    - 6 steps as specified in AC2
    - Tips section
    - Related: Register, Marketplace guides
  - [x] 2.3 Create `apps/web/src/features/support/pages/guides/GuideMarketplaceOptInPage.tsx`
    - H1: "How to Opt Into the Marketplace"
    - Time: 2 minutes
    - Prerequisites: Registration, completed survey
    - 5 steps as specified in AC3
    - Info section about visibility
    - Related: Survey guide
  - [x] 2.4 Create `apps/web/src/features/support/pages/guides/GuideGetNinPage.tsx`
    - H1: "How to Get a NIN"
    - Time: 30-60 minutes at NIMC
    - What is NIN explanation
    - 5 steps as specified in AC4
    - NIMC link: https://nimc.gov.ng/enrollment-centers/
    - Related: Register guide

- [x] **Task 3: Employer Guide Pages** (AC: 5, 6, 7)
  - [x] 3.1 Create `apps/web/src/features/support/pages/guides/GuideSearchMarketplacePage.tsx`
    - H1: "How to Search the Marketplace"
    - Time: Instant
    - Prerequisites: None (or employer account for contacts)
    - 5 steps as specified in AC5
    - Tips section
    - Related: Employer Account guide
  - [x] 3.2 Create `apps/web/src/features/support/pages/guides/GuideEmployerAccountPage.tsx`
    - H1: "Setting Up an Employer Account"
    - Time: 2 minutes
    - Why register section
    - 5 steps as specified in AC6
    - Related: Search Marketplace guide
  - [x] 3.3 Create `apps/web/src/features/support/pages/guides/GuideVerifyWorkerPage.tsx`
    - H1: "How to Verify a Worker"
    - Time: 1 minute
    - What verification confirms section
    - 5 steps as specified in AC7
    - Link to `/support/verify-worker`

- [x] **Task 4: Update GuidesPage.tsx Links** (AC: 8)
  - [x] 4.1 Update worker guide card links in `workerGuides` array:
    - "How to Register": change `href` from `/participate/workers` to `/support/guides/register`
    - "How to Complete the Survey": change `href` from `/participate/workers#survey` to `/support/guides/survey`
    - "How to Opt Into the Marketplace": change `href` from `/participate/workers#marketplace` to `/support/guides/marketplace-opt-in`
    - "How to Get a NIN": change `href` from `https://nimc.gov.ng/enrollment-centers/` to `/support/guides/get-nin` **AND remove `external: true`**
  - [x] 4.2 Update employer guide card links in `employerGuides` array:
    - "How to Search the Marketplace": change `href` from `/participate/employers` to `/support/guides/search-marketplace`
    - "How to Create an Employer Account": change `href` from `/register` to `/support/guides/employer-account`
    - "How to Verify a Worker": change `href` from `/support/verify-worker` to `/support/guides/verify-worker` (guide page, not the tool itself)

- [x] **Task 5: Route Updates in App.tsx** (AC: 9)
  - [x] 5.1 Add lazy imports for all 7 guide detail pages:
    ```tsx
    const GuideRegisterPage = lazy(() => import('./features/support/pages/guides/GuideRegisterPage'));
    const GuideSurveyPage = lazy(() => import('./features/support/pages/guides/GuideSurveyPage'));
    const GuideMarketplaceOptInPage = lazy(() => import('./features/support/pages/guides/GuideMarketplaceOptInPage'));
    const GuideGetNinPage = lazy(() => import('./features/support/pages/guides/GuideGetNinPage'));
    const GuideSearchMarketplacePage = lazy(() => import('./features/support/pages/guides/GuideSearchMarketplacePage'));
    const GuideEmployerAccountPage = lazy(() => import('./features/support/pages/guides/GuideEmployerAccountPage'));
    const GuideVerifyWorkerPage = lazy(() => import('./features/support/pages/guides/GuideVerifyWorkerPage'));
    ```
  - [x] 5.2 Convert `/support/guides` from single route to nested route structure:
    ```tsx
    <Route path="guides">
      <Route
        index
        element={
          <Suspense fallback={<PageLoadingFallback />}>
            <GuidesPage />
          </Suspense>
        }
      />
      <Route
        path="register"
        element={
          <Suspense fallback={<PageLoadingFallback />}>
            <GuideRegisterPage />
          </Suspense>
        }
      />
      {/* ... remaining 6 guide routes */}
    </Route>
    ```

- [x] **Task 6: Testing** (AC: 11)
  - [x] 6.1 Create `apps/web/src/features/support/__tests__/guides/GuideRegisterPage.test.tsx`
  - [x] 6.2 Create `apps/web/src/features/support/__tests__/guides/GuideSurveyPage.test.tsx`
  - [x] 6.3 Create `apps/web/src/features/support/__tests__/guides/GuideMarketplaceOptInPage.test.tsx`
  - [x] 6.4 Create `apps/web/src/features/support/__tests__/guides/GuideGetNinPage.test.tsx`
  - [x] 6.5 Create `apps/web/src/features/support/__tests__/guides/GuideSearchMarketplacePage.test.tsx`
  - [x] 6.6 Create `apps/web/src/features/support/__tests__/guides/GuideEmployerAccountPage.test.tsx`
  - [x] 6.7 Create `apps/web/src/features/support/__tests__/guides/GuideVerifyWorkerPage.test.tsx`
  - [x] 6.8 Update GuidesPage tests to verify links point to detail pages
  - [x] 6.9 Test all guide pages have required sections

## Dev Notes

### File Structure

```
apps/web/src/features/support/
├── components/
│   ├── GuidePageLayout.tsx      (NEW - Task 1.1)
│   ├── StepList.tsx             (NEW - Task 1.2)
│   ├── TipCard.tsx              (NEW - Task 1.3)
│   ├── RelatedGuides.tsx        (NEW - Task 1.4)
│   ├── GuideCard.tsx            (existing)
│   ├── SupportCard.tsx          (existing)
│   └── ...
├── pages/
│   ├── guides/
│   │   ├── GuideRegisterPage.tsx          (NEW)
│   │   ├── GuideSurveyPage.tsx            (NEW)
│   │   ├── GuideMarketplaceOptInPage.tsx  (NEW)
│   │   ├── GuideGetNinPage.tsx            (NEW)
│   │   ├── GuideSearchMarketplacePage.tsx (NEW)
│   │   ├── GuideEmployerAccountPage.tsx   (NEW)
│   │   └── GuideVerifyWorkerPage.tsx      (NEW)
│   ├── GuidesPage.tsx           (MODIFY - Task 4)
│   └── ...
└── __tests__/
    └── guides/
        └── *.test.tsx           (NEW - Task 6)
```

### URL Mapping Reference

| Guide Card Title | New URL |
|------------------|---------|
| How to Register | `/support/guides/register` |
| How to Complete the Survey | `/support/guides/survey` |
| How to Opt Into the Marketplace | `/support/guides/marketplace-opt-in` |
| How to Get a NIN | `/support/guides/get-nin` |
| How to Search the Marketplace | `/support/guides/search-marketplace` |
| Setting Up an Employer Account | `/support/guides/employer-account` |
| How to Verify a Worker | `/support/guides/verify-worker` |

### Current GuidesPage.tsx Link Pattern

The current GuidesPage uses placeholder links and anchor links. Current state:

**Worker Guides (lines 16-42):**
| Title | Current href | Has `external` |
|-------|--------------|----------------|
| How to Register | `/participate/workers` | No |
| How to Complete the Survey | `/participate/workers#survey` | No |
| How to Opt Into the Marketplace | `/participate/workers#marketplace` | No |
| How to Get a NIN | `https://nimc.gov.ng/enrollment-centers/` | **Yes** |

**Employer Guides (lines 47-66):**
| Title | Current href |
|-------|--------------|
| How to Search the Marketplace | `/participate/employers` |
| How to Create an Employer Account | `/register` |
| How to Verify a Worker | `/support/verify-worker` |

### GuideCard Component Interface

```tsx
interface GuideCardProps {
  title: string;
  description: string;
  icon: LucideIcon;
  href: string;
  external?: boolean;  // If true, opens in new tab with external link icon
}
```

When `external: true`, the component renders an external link. For the NIN guide, we're changing this to an internal page that contains the external NIMC link.

### Shared Component Design

**GuidePageLayout** should provide:
- Consistent header with title and time estimate badge
- Prerequisites section (conditionally rendered)
- Content area for step list and additional sections
- Footer with "Back to Guides" link
- Optional "Related Guides" section

This ensures visual consistency across all 7 guide pages while allowing content flexibility.

### Content Note

Phase 1 content can be simplified/placeholder but must maintain the structure defined in ACs. Full content can be enhanced in later iterations.

---

## Dev Agent Record

### File List

**Shared Components (4):**
- `apps/web/src/features/support/components/GuidePageLayout.tsx`
- `apps/web/src/features/support/components/StepList.tsx`
- `apps/web/src/features/support/components/TipCard.tsx`
- `apps/web/src/features/support/components/RelatedGuides.tsx`

**Worker Guide Pages (4):**
- `apps/web/src/features/support/pages/guides/GuideRegisterPage.tsx`
- `apps/web/src/features/support/pages/guides/GuideSurveyPage.tsx`
- `apps/web/src/features/support/pages/guides/GuideMarketplaceOptInPage.tsx`
- `apps/web/src/features/support/pages/guides/GuideGetNinPage.tsx`

**Employer Guide Pages (3):**
- `apps/web/src/features/support/pages/guides/GuideSearchMarketplacePage.tsx`
- `apps/web/src/features/support/pages/guides/GuideEmployerAccountPage.tsx`
- `apps/web/src/features/support/pages/guides/GuideVerifyWorkerPage.tsx`

**Test Files (7):**
- `apps/web/src/features/support/__tests__/guides/GuideRegisterPage.test.tsx`
- `apps/web/src/features/support/__tests__/guides/GuideSurveyPage.test.tsx`
- `apps/web/src/features/support/__tests__/guides/GuideMarketplaceOptInPage.test.tsx`
- `apps/web/src/features/support/__tests__/guides/GuideGetNinPage.test.tsx`
- `apps/web/src/features/support/__tests__/guides/GuideSearchMarketplacePage.test.tsx`
- `apps/web/src/features/support/__tests__/guides/GuideEmployerAccountPage.test.tsx`
- `apps/web/src/features/support/__tests__/guides/GuideVerifyWorkerPage.test.tsx`

**Modified Files:**
- `apps/web/src/features/support/pages/GuidesPage.tsx` - Updated all guide links to point to detail pages
- `apps/web/src/features/support/components/index.ts` - Added exports for new shared components
- `apps/web/src/App.tsx` - Added lazy imports and nested routes under /support/guides/*

### Completion Notes

- 7 guide detail pages implemented with full content (not Lorem ipsum)
- 4 shared components provide consistent layout across all guides
- GuidePageLayout includes: back link, title, time estimate, prerequisites, content slot, related guides
- StepList renders numbered steps with clear visual hierarchy
- TipCard supports 3 variants: info, warning, success
- RelatedGuides displays grid of related guide links
- All guide cards in GuidesPage.tsx now link to detail pages (no more external/anchor links)
- 53 new tests added (444 total tests passing)
- ESLint clean, TypeScript clean

### Change Log

| Date | Author | Changes |
|------|--------|---------|
| 2025-01-24 | Dev Agent (Amelia) | Code review - updated story status, tasks, and added Dev Agent Record |

## References

- public-website-ia.md: Section 5.3 Guides wireframe (lines 1657-1754)
- Story 1.5.5: Support Section (GuidesPage implementation)
- PRD FR1.2: Worker digital registration journey
- PRD FR2: Employer marketplace access
