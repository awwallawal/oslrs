# generated: 2026-01-23
# updated: 2026-02-20 - Epic 4 complete (5 stories + 9 prep). Prep-epic-5 (7 tasks) added. Story 5.5 added. Baselines: 667 API, 1512 web tests
# project: oslr_cl
# project_key: oslr_cl
# tracking_system: file-system
# story_location: _bmad-output/implementation-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Epic Status Transitions:
#   - backlog → in-progress: Automatically when first story is created (via create-story)
#   - in-progress → done: Manually when all stories reach 'done' status
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - ready-for-dev: Story file created in stories folder
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review (via Dev's code-review workflow)
#   - done: Story completed
#   - superseded: Story replaced by course correction (SCP). Code removed or never needed.
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - done: Retrospective has been completed
#
# WORKFLOW NOTES:
# ===============
# - Epic transitions to 'in-progress' automatically when first story is created
# - Stories can be worked in parallel if team capacity allows
# - SM typically creates next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)

generated: "2026-01-23"
project: "oslr_cl"
project_key: "oslr_cl"
tracking_system: "file-system"
story_location: "_bmad-output/implementation-artifacts"

development_status:
  # Epic 1: Foundation, Secure Access & Staff Onboarding
  # Updated: 2026-01-13 - Added stories 1.8, 1.9, 1.10 from validation audit
  epic-1: done
  1-1-project-initialization-ci-cd-pipeline: done
  1-2-database-schema-access-control-rbac: done
  1-3-staff-provisioning-bulk-import: done
  1-4-staff-activation-profile-completion: done
  1-5-live-selfie-capture-verification: done
  1-6-id-card-generation-public-verification: done
  1-7-secure-login-session-management: done
  1-8-public-user-self-registration: done
  1-9-global-ui-patterns: done
  1-10-test-infrastructure-dashboard: done
  1-11-email-invitation-system: done  # Complete 2026-01-25: All ACs implemented, 9/9 tests pass, NIN validation fixed (Modulus 11)
  epic-1-retrospective: done  # Completed 2026-01-18

  # Epic 1.5: Public Website Foundation (Phase 1 Static)
  # Added: 2026-01-22 - Per Epic 1 retrospective decision to build static frontend before Epic 2
  # Source: docs/public-website-ia.md, ux-design-specification.md, ADR-016
  epic-1.5: done  # Completed 2026-01-24: All 8 stories done, retrospective complete
  1.5-1-design-system-foundation-layout-architecture: done
  1.5-2-homepage-implementation: done
  1.5-3-about-section-6-pages: done  # Code review passed 2026-01-23
  1.5-4-participate-section-3-pages: done  # Completed 2026-01-23
  1.5-5-support-section-5-pages: done  # Completed 2026-01-23
  1.5-6-legal-pages-navigation-cleanup: done  # Completed 2026-01-24: Terms + Nav/Footer cleanup
  1.5-7-guide-detail-pages: done  # Completed 2026-01-24: 7 guide detail pages with shared components
  1.5-8-navigation-footer-polish: done  # Completed 2026-01-24: Code review passed, all 9 ACs verified
  epic-1.5-retrospective: done  # Completed 2026-01-24: Deep-dive with gap analysis, Story 1.5-8 created

  # Epic 2: Questionnaire Management & Native Form System
  # Updated: 2026-02-06 - Per SCP-2026-02-05-001: ODK removed, native form system replaces
  # Stories 2.2-2.6 SUPERSEDED, new Stories 2.7-2.10 added for native forms
  epic-2: done  # Completed 2026-02-10: ODK stories superseded (SCP-2026-02-05-001), native form stories 2.7-2.10 done. Combined retro with Epic 2.5.
  2-1-xlsform-upload-validation: done  # Completed 2026-01-27: Retained for one-time migration only (see Story 2.9)
  2-2-odk-central-form-deployment: superseded  # SCP-2026-02-05-001: ODK removed, replaced by Stories 2.7-2.10
  2-6-odk-mock-server-integration-testing: superseded  # SCP-2026-02-05-001: ODK removed
  2-3-automated-odk-app-user-provisioning: superseded  # SCP-2026-02-05-001: ODK removed
  2-4-encrypted-odk-token-management: superseded  # SCP-2026-02-05-001: ODK removed
  2-5-odk-sync-health-monitoring: superseded  # SCP-2026-02-05-001: ODK removed
  2-7-native-form-schema-types: done  # Code review passed 2026-02-07: 8 issues fixed (5M, 3L), 22 tests pass, 0 regressions
  2-8-skip-logic-form-services: done  # Code review passed 2026-02-07: 10 issues found, 9 fixed, 1 dismissed (false positive), 47 tests pass
  2-9-xlsform-migration-script: done  # Code review passed 2026-02-07: 10 issues found (2H, 5M, 3L), all fixed. 30 tests pass (22 original + 8 review). Transaction wrapping, test coverage gaps closed.
  2-10-native-form-builder-ui: done  # Code review passed 2026-02-07: 13 issues found (5H, 4M, 3L), 9 fixed (5H, 2M, 1L, 1 test fix), 2 accepted (M2 false positive, M3 adequate coverage). 780 web tests pass, 0 regressions.
  epic-2-retrospective: done  # Completed 2026-01-31 (original), Combined retro 2026-02-10 with Epic 2.5

  # Epic 2.5: Role-Based Dashboards & Feature Integration
  # Added: 2026-01-31 - Per Epic 2 retrospective decision to scaffold role dashboards before Epic 3
  # Updated: 2026-02-06 - Story 2.5-2 needs cleanup post-ODK removal (SCP-2026-02-05-001)
  # Source: ux-design-specification.md, ux-design-directions.html, ADR-016
  # Security: Strict route isolation (each role can ONLY access their own dashboard)
  epic-2.5: done  # Completed 2026-02-10: All 8 stories done, combined retro with Epic 2
  2.5-1-dashboard-layout-architecture-role-routing: done  # Code review passed 2026-01-31: All fixes applied, 578 web tests pass
  2.5-2-super-admin-questionnaires-form-management: done  # Code review passed 2026-02-01: 620 web tests pass. NEEDS CLEANUP: Remove ODK components, add Form Builder links (SCP-2026-02-05-001)
  2.5-3-super-admin-staff-management: done  # Code Review #2 passed 2026-02-06: All 8 issues resolved (2H, 4M, 2L), zero technical debt. 247 API + 766 web tests pass
  2.5-4-supervisor-dashboard-shell: done  # Code review passed 2026-02-08: 6 findings (1H, 3M, 2L) all fixed. 800 web tests pass, 0 regressions.
  2.5-5-enumerator-dashboard-shell: done  # Code review passed 2026-02-08: 7 findings (2H, 3M, 2L), all fixed. 823 web tests pass, 0 regressions.
  2.5-6-data-entry-clerk-dashboard: done  # Code review passed 2026-02-09: 7 findings (1H, 4M, 2L), all H+M fixed. 851 web tests pass, 0 regressions.
  2.5-7-assessor-official-dashboards: done  # Code review passed 2026-02-09: 8 findings (2H, 3M, 3L), all 8 fixed. 917 web tests pass, 0 regressions.
  2.5-8-public-user-rbac-testing: done  # Code review passed 2026-02-10: 7 findings (1H, 3M, 3L), 6/7 fixed. 957 web tests pass (+3 new), 0 regressions.
  epic-2.5-retrospective: done  # Completed 2026-02-10: Combined retro with Epic 2. Pivot analysis, preview gap identified, 3-layer quality strategy agreed.

  # Prep Phase: Epic 3 Readiness (from Combined Epic 2+2.5 Retrospective 2026-02-10)
  # Source: epic-2-2.5-retrospective-2026-02-10.md Action Items
  # Must complete before Epic 3 begins. Incorporates tech debt (T1-T3) and prep tasks (EP1-EP7).
  prep-epic-3: done  # All 8 prep tasks completed 2026-02-11
  prep-1-odk-cleanup-story-2.5-2: done  # EP1 + T1: Remove dead ODK components from 2.5-2, wire Form Builder links
  prep-2-shared-role-constants: done  # T3: Create shared role constants in packages/types. Code review passed 2026-02-11: 8 findings (1H, 3M, 4L), 7 fixed, 1 accepted. 957 web tests pass, 0 regressions.
  prep-3-db-migration-workflow-fix: done  # T2 + EP5: Fix db:push interactive prompt, write migration workflow guide. Code review passed 2026-02-11: 8 findings (1H, 4M, 3L), all 8 resolved. Live UAT verified against PostgreSQL. 1,354 tests pass, 0 regressions.
  prep-4-playwright-framework-setup: done  # EP3: Playwright setup + smoke tests + handholding guide. Code review passed 2026-02-11: 8 findings (5M, 3L), 7 fixed, 1 accepted (L2). 3 E2E + 957 web tests pass, 0 regressions.
  prep-5-service-worker-indexeddb-spike: done  # EP4: Research spike for offline storage — blocks Stories 3.2, 3.3. Code review passed 2026-02-11: 9 findings (5M, 4L), all 9 fixed. 971 web tests pass, 0 regressions.
  prep-6-load-test-baseline: done  # EP6: k6 load test scripts + baseline report. Code review passed 2026-02-11: 8 findings (2H, 5M, 1L), all 8 fixed. 971 tests pass, 0 regressions.
  prep-7-e2e-golden-path-spec: done  # EP7: Golden path spec complete. 11 stubs + GP-1 active (4 passed, 17 skipped). Code review passed 2026-02-11: 9 findings (1H, 5M, 3L), 8 fixed, 1 acknowledged.
  prep-8-update-story-3.1-acs: done  # EP2: Add admin form preview AC to Story 3.1 (same FormFillerPage in read-only sandbox mode). Code review passed 2026-02-11: 7 findings (2H, 3M, 2L), all 7 fixed.

  # Standalone: Performance & SEO
  # Added: 2026-02-12 - Cross-cutting perf/SEO work not tied to a specific epic
  perf-1-lcp-optimization-and-sitemap: done  # Code review passed 2026-02-12: 6 findings (1H, 2M, 3L), all 6 fixed. 978 web tests pass, 0 regressions.

  # Epic 3: Mobile Data Collection & Ingestion Pipeline
  # Updated: 2026-02-06 - Story 3.1 rewritten (Enketo → Native), Story 3.4 repurposed (SCP-2026-02-05-001)
  # NOTE: Story 3.1 ACs to be updated per prep-8 (admin form preview from retro)
  epic-3: done  # Completed 2026-02-14: All 8 stories done (3-0 through 3-7), retrospective complete. 362 API + 1,240 web tests.
  3-0-google-oauth-enhanced-public-registration: done  # Completed 2026-02-12. All 12 tasks done, 280 API + 971 web tests pass. Code review passed.
  3-1-native-form-renderer-dashboard: done  # Code review passed 2026-02-12: 10 findings (3C, 4H, 3M), all fixed. 99+ tests pass (92 web + 7 API), 0 regressions.
  3-2-pwa-service-worker-offline-assets: done  # Code review passed 2026-02-12: 8 findings (2H, 4M, 2L), all fixed. ML model CDN route, offline toast, A3 test violations, amber color. 1,096 web tests pass, 0 regressions.
  3-3-offline-queue-sync-status-ui: done  # Code review passed 2026-02-13: 13 findings (3C, 5H, 4M, 1L), all 13 fixed. 96 tests pass (84 web + 12 API), 0 regressions.
  3-4-idempotent-submission-ingestion-bullmq: done  # Code review passed 2026-02-13: 12 findings (2C, 3H, 4M, 3L) all fixed + 3 extras (rate-limit fix, formXmlId rename, NIN E2E test). 337 API + 1,164 web tests pass, 0 regressions.
  3-5-public-self-registration-survey-access: done  # Code review passed 2026-02-13: 5 findings (3M, 2L), all fixed. Description field, 3-state drafts, role-based detection, test cleanup, CSS extraction. 81 tests pass, 0 regressions.
  3-6-keyboard-optimized-data-entry-interface-clerks: done  # Code review R2 passed 2026-02-14: R1 9 findings all fixed, R2 9 findings (3H, 4M, 2L) all fixed. 60 tests pass, 0 regressions
  3-7-global-nin-uniqueness-enforcement: done  # Code review passed 2026-02-14: 13 findings (3C, 4H, 4M, 2L), all 13 fixed. 362 API + 1240 web tests pass, 0 regressions.
  epic-3-retrospective: done  # Completed 2026-02-14: 16-story scope (8 prep + 8 epic). 149 CR findings, 93% retro follow-through, 10 prep tasks for Epic 4.

  # Prep Phase: Epic 4 Readiness (from Epic 3 Retrospective 2026-02-14)
  # Source: epic-3-retro-2026-02-14.md Action Items
  # Must complete before Epic 4 begins. Includes bug fixes (B1-B2), PRD alignment (FR21),
  # tech debt (T4-T6 carried), spikes (messaging, fraud), and schema prep.
  prep-epic-4: in-progress
  prep-1-fix-permanently-completed-form-bug: done  # B1 CRITICAL: Allow new submissions for same form after previous ones complete. Code review passed 2026-02-15: 7 findings (1H, 3M, 3L), all 7 fixed. 1,246 web tests pass, 0 regressions.
  prep-2-dashboard-submission-counters: done  # B2 HIGH: Dashboard productivity upgrade. R1: 6 findings all fixed. R2 (Tasks 10-20): 7 findings (2H, 1M, 4L), 5 fixed + 1 noted. 1,303 web + 394 API tests pass, 0 regressions.
  prep-3-fr21-prd-alignment: done  # HIGH: Update PRD FR21 — change NIN duplicate behavior from "link" to "reject"
  prep-4-react-hook-form-zod-migration: done  # TD-4.1 MEDIUM: Migrate FormFillerPage and ClerkDataEntryPage to RHF+Zod per ADR-4.3
  prep-5-a3-eslint-enforcement: done  # MEDIUM: Add ESLint rule blocking CSS class selectors in test files (T4 carried)
  prep-6-realtime-messaging-spike: done  # HIGH: WebSocket/SSE research for Story 4.2 — validate approach, choose library, create PoC. Socket.io 4.8.3 selected, PoC complete, 43 tests. Code review passed 2026-02-17: 10 findings (1C, 3H, 4M, 2L), 9 fixed, 1 deferred (L2 test dedup).
  prep-7-fraud-detection-domain-research: done  # HIGH: GPS clustering, speed-run detection heuristics for Story 4.3. Define threshold schema. All 5 tasks + 8 review fixes complete, 67 tests, 0 regressions. Code review passed 2026-02-17: 8 findings (2H, 3M, 3L), all 8 fixed.
  prep-8-supervisor-team-assignment-schema: done  # HIGH: Schema + service + seeds + 15 tests. Code review passed 2026-02-17: 8 findings (3H, 3M, 2L), 7/8 fixed (L2 deferred). 482 API tests pass, 0 regressions.
  prep-9-fileblob-base64-to-bytea: done  # Already resolved in Story 2.2 migration (ALTER COLUMN file_blob TYPE bytea). Custom Drizzle bytea type in questionnaires.ts. Retros carried forward without verifying. Closed 2026-02-17.
  prep-10-sub-path-exports-types: done  # Dropped 2026-02-17 — cosmetic. All 106+ imports use root @oslsr/types with complete re-exports from index.ts. Zero developer friction.
  prep-11-offline-queue-user-isolation: done  # MEDIUM: Security — shared-device user isolation for offline drafts/submissions. Code review passed 2026-02-18: 9 findings (3C, 3M, 3L), 6 fixed (3C build-breaking type/mock errors, 1M async bug, 2M story doc gaps), 3 deferred (L1-L3 test coverage gaps).

  # Epic 4: Supervisor Oversight & Field Management
  epic-4: done  # Completed 2026-02-20: All 5 stories done, retrospective complete
  4-1-supervisor-team-dashboard: done  # Code review passed 2026-02-19: 9 findings (1H, 3M, 5L), ALL 9 fixed. ErrorBoundary, local markers, 60s polling, WAT timezone, L1 migrated overview+alerts to TeamAssignmentService. 24 backend + 25 frontend supervisor tests, 0 regressions.
  4-2-in-app-team-messaging: done  # Code review R2 passed 2026-02-19: R1 11 findings (9 fixed, 2 deferred). R2 9 findings (2C, 2H, 3M, 2L) all 9 fixed. Chat order reversal, cursor parsing, O(n²) inbox, markThreadAsRead tests, content-shaped skeletons, client Zod validation, broadcast targeting. 519 API + 1416 web tests pass, 0 regressions.
  4-3-fraud-engine-configurable-thresholds: done  # Code review passed 2026-02-20: 12 findings (4H, 5M, 3L), all 12 fixed. H3 speed-run form filter, M2 DBSCAN O(n²), M3 query validation, M4-M5 test expansion (111→118 tests), L1 getThreshold DRY extraction. 118 fraud-specific tests pass, 0 regressions.
  4-4-flagged-submission-review-evidence-panel: done  # Code review passed 2026-02-20: 10 findings (3H, 4M, 3L), 9 fixed, 1 deferred (L3). 23 backend + 40 frontend tests, 1,462 total pass, 0 regressions.
  4-5-bulk-verification-of-mass-events: done  # Code review passed 2026-02-20: 8 findings (2H, 5M, 1L), all 8 fixed. H1+H2 cluster members endpoint enriched, M1 dynamic toast count, M3 shared leaflet-icons, M4 radius from DB config, M5 ClusterDetailView tests (12), L1 audit action name. 667 API + 1512 web tests pass, 0 regressions.
  epic-4-retrospective: done  # Completed 2026-02-20: 14-story scope (9 prep + 5 epic). 133 CR findings, 100% retro follow-through, 7 prep tasks for Epic 5. Story 5.5 (Respondent Data Registry Table) added.

  # Prep Phase: Epic 5 Readiness (from Epic 4 Retrospective 2026-02-20)
  # Source: epic-4-retro-2026-02-20.md Action Items + Prep Tasks
  # Must complete before Epic 5 begins. Includes bug fix (prep-1), audit logging (prep-2),
  # export spike (prep-3), story definition (prep-4), performance validation (prep-5),
  # workflow design (prep-6), E2E expansion (prep-7), and role-based activation (prep-8).
  prep-epic-5: in-progress
  prep-1-fix-supervisor-direct-messaging-ux: done  # HIGH: Add "New Conversation" flow with team roster selection to SupervisorMessagesPage. Code review passed 2026-02-21: 8 findings (1H, 3M, 4L), all 8 fixed. 51 messaging tests, 558 dashboard tests pass, 0 regressions.
  prep-2-lightweight-audit-logging-pii-access: ready-for-dev  # HIGH: Required by Stories 5.3, 5.4, 5.5. Decide: build lightweight audit logger now, or pull Story 6.1 forward partially.
  prep-3-export-infrastructure-spike: ready-for-dev  # HIGH: CSV/PDF generation with security controls (logged, role-authorized). Evaluate PDFKit (already installed) + CSV library.
  prep-4-define-story-5.5-in-epics: done  # HIGH: Story 5.5 fully defined in epics.md with access control matrix, 9 filters, column visibility matrix, technical requirements. Uncommitted — needs commit.
  prep-5-cross-lga-query-performance-validation: ready-for-dev  # MEDIUM: Run state-wide aggregation queries at scale. Ensure Official/Assessor views don't degrade.
  prep-6-assessor-workflow-state-machine-design: ready-for-dev  # MEDIUM: Document submission lifecycle: submission -> fraud scoring -> supervisor review -> assessor audit -> final status.
  prep-7-e2e-test-expansion: ready-for-dev  # NICE-TO-HAVE: Playwright tests for fraud threshold UI, messaging inbox, supervisor team dashboard.
  prep-8-role-based-activation-wizard: ready-for-dev  # MEDIUM: Simplify onboarding for back-office roles (Official, Assessor, Super Admin) — password-only activation instead of full 5-step wizard. Field roles (Enumerator, Supervisor, Clerk) keep all 5 steps. Bank data already captured for Epic 6 reuse.

  # Epic 5: Back-Office Audit & Policy Reporting
  epic-5: in-progress
  5-1-high-level-policy-dashboard: ready-for-dev
  5-2-verification-assessor-audit-queue: ready-for-dev
  5-3-individual-record-pii-view-authorized-roles: backlog
  5-4-pii-rich-csv-pdf-exports: backlog
  5-5-respondent-data-registry-table: backlog  # NEW from Epic 4 retro: Server-paginated, filterable table of all respondent records for authorized roles
  epic-5-retrospective: optional

  # Epic 6: System Integrity, Accountability & Remuneration
  # Note: View-As feature (Super Admin debug capability) deferred here from Epic 2.5
  epic-6: backlog
  6-1-immutable-append-only-audit-logs: backlog
  6-2-system-health-performance-monitoring: backlog
  6-3-automated-off-site-backup-orchestration: backlog
  6-4-staff-remuneration-bulk-recording: backlog
  6-5-staff-payment-history-dispute-mechanism: backlog
  6-6-payment-dispute-resolution-queue: backlog
  6-7-super-admin-view-as-feature: backlog  # Deferred from Epic 2.5: Debug/demo capability with audit trail
  epic-6-retrospective: optional

  # Epic 7: Public Skills Marketplace & Search Security
  epic-7: backlog
  7-1-marketplace-data-extraction-worker: backlog
  7-2-public-marketplace-search-interface: backlog
  7-3-anonymous-profile-government-verified-badges: backlog
  7-4-authenticated-contact-reveal-captcha: backlog
  7-5-profile-enrichment-via-edit-token: backlog
  7-6-contact-view-logging-rate-limiting: backlog
  epic-7-retrospective: optional


